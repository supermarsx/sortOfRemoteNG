@tailwind base;
@tailwind components;
@tailwind utilities;

/* Override Tailwind's default border color (gray-200) with the theme variable.
   This ensures bare `border`, `border-b`, etc. classes use the themed color
   instead of a hardcoded light gray that looks white on dark/OLED themes. */
@layer base {
  *,
  ::before,
  ::after {
    border-color: var(--color-border);
  }
}

/* Default color variables so the UI has sensible colors before the ThemeManager runs */
:root {
  --color-primary: #3b82f6;
  --color-secondary: #6b7280;
  --color-accent: #10b981;
  --color-background: #111827;
  --color-surface: #1f2937;
  --color-text: #f9fafb;
  --color-textSecondary: #d1d5db;
  --color-border: #374151;
  --color-success: #10b981;
  --color-warning: #f59e0b;
  --color-error: #ef4444;
  
  /* Animation variables */
  --animation-duration: 550ms;
  --animation-enabled: 1;
}

/* Reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  :root {
    --animation-duration: 0ms;
    --animation-enabled: 0;
  }
}

/* Disable animations class */
.animations-disabled {
  --animation-duration: 0ms !important;
  --animation-enabled: 0 !important;
}

.animations-disabled *,
.animations-disabled *::before,
.animations-disabled *::after {
  animation-duration: 0ms !important;
  animation-delay: 0ms !important;
  transition-duration: 0ms !important;
  transition-delay: 0ms !important;
}

/* Reduced motion class */
.reduce-motion {
  --animation-duration: 50ms !important;
}

.reduce-motion *,
.reduce-motion *::before,
.reduce-motion *::after {
  animation-duration: 50ms !important;
  transition-duration: 50ms !important;
}

body {
  background-color: var(--color-background);
  color: var(--color-text);
}

/* Map commonly used Tailwind utility classes to theme variables */
.bg-gray-900,
.bg-gray-800,
.bg-gray-750,
.bg-gray-700 {
  background-color: var(--color-surface) !important;
}

.bg-gray-600,
.bg-gray-500 {
  background-color: var(--color-border) !important;
}

.bg-blue-400,
.bg-blue-500,
.bg-blue-600,
.bg-blue-700,
.bg-blue-900 {
  background-color: var(--color-primary) !important;
}

.bg-green-400,
.bg-green-500,
.bg-green-600,
.bg-green-700 {
  background-color: var(--color-success) !important;
}

.bg-red-400,
.bg-red-500,
.bg-red-600,
.bg-red-700,
.bg-red-900 {
  background-color: var(--color-error) !important;
}

.bg-yellow-400,
.bg-yellow-500,
.bg-orange-900 {
  background-color: var(--color-warning) !important;
}

.text-gray-200,
.text-gray-300,
.text-gray-400,
.text-gray-500 {
  color: var(--color-textSecondary) !important;
}

.text-white {
  color: var(--color-text) !important;
}

.text-blue-200,
.text-blue-300,
.text-blue-400,
.text-blue-600 {
  color: var(--color-primary) !important;
}

.text-green-400 {
  color: var(--color-success) !important;
}

.text-red-300,
.text-red-400 {
  color: var(--color-error) !important;
}

.text-purple-400 {
  color: var(--color-accent) !important;
}

.text-orange-300,
.text-orange-400,
.text-yellow-400 {
  color: var(--color-warning) !important;
}

.border-gray-500,
.border-gray-600,
.border-gray-700,
.border-gray-800 {
  border-color: var(--color-border) !important;
}

.divide-gray-600 > :not([hidden]) ~ :not([hidden]),
.divide-gray-700 > :not([hidden]) ~ :not([hidden]),
.divide-gray-800 > :not([hidden]) ~ :not([hidden]) {
  border-color: var(--color-border) !important;
}

.border-blue-400,
.border-blue-500,
.border-blue-700 {
  border-color: var(--color-primary) !important;
}

.border-green-500 {
  border-color: var(--color-success) !important;
}

.border-red-500,
.border-red-700 {
  border-color: var(--color-error) !important;
}

.border-orange-400,
.border-orange-700 {
  border-color: var(--color-warning) !important;
}

/* Hover background color mappings for light theme compatibility */
.hover\:bg-gray-600:hover,
.hover\:bg-gray-700:hover,
.hover\:bg-gray-700\/50:hover,
.hover\:bg-gray-800:hover {
  background-color: var(--color-surfaceHover) !important;
}

.hover\:bg-gray-500:hover {
  background-color: var(--color-border) !important;
}

/* Additional hover mappings for buttons and interactive elements */
.hover\:bg-\[var\(--color-surfaceHover\)\]:hover {
  background-color: var(--color-surfaceHover) !important;
}

.hover\:bg-\[var\(--color-surface\)\]:hover {
  background-color: var(--color-surface) !important;
}

/* Active/pressed state mappings */
.active\:bg-gray-700:active,
.active\:bg-gray-800:active {
  background-color: var(--color-surfaceActive, var(--color-surfaceHover)) !important;
}

/* Hover text color mappings for light theme compatibility */
.hover\:text-white:hover {
  color: var(--color-text) !important;
}

.hover\:text-gray-100:hover,
.hover\:text-gray-200:hover,
.hover\:text-gray-300:hover {
  color: var(--color-textSecondary) !important;
}

/* Light theme specific overrides for better hover visibility */
[data-theme="light"] .hover\:bg-gray-600:hover,
[data-theme="light"] .hover\:bg-gray-700:hover,
[data-theme="light"] .hover\:bg-gray-700\/50:hover,
[data-theme="light"] .hover\:bg-gray-800:hover,
[data-theme="semilight"] .hover\:bg-gray-600:hover,
[data-theme="semilight"] .hover\:bg-gray-700:hover,
[data-theme="semilight"] .hover\:bg-gray-700\/50:hover,
[data-theme="semilight"] .hover\:bg-gray-800:hover {
  background-color: var(--color-surfaceHover) !important;
  box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.05);
}

/* Light theme button enhancements */
[data-theme="light"] button:hover,
[data-theme="semilight"] button:hover {
  transition: background-color 0.15s ease, box-shadow 0.15s ease;
}
/* Light theme input and form element overrides */
[data-theme="light"] .bg-gray-700,
[data-theme="semilight"] .bg-gray-700 {
  background-color: var(--color-input, #ffffff) !important;
  color: var(--color-text) !important;
}

[data-theme="light"] .bg-gray-800,
[data-theme="semilight"] .bg-gray-800 {
  background-color: var(--color-surface) !important;
  color: var(--color-text) !important;
}

[data-theme="light"] .bg-gray-800\/40,
[data-theme="semilight"] .bg-gray-800\/40 {
  background-color: color-mix(in srgb, var(--color-surface) 60%, transparent) !important;
}

[data-theme="light"] .bg-gray-700\/50,
[data-theme="semilight"] .bg-gray-700\/50 {
  background-color: color-mix(in srgb, var(--color-input, #ffffff) 50%, transparent) !important;
}

[data-theme="light"] .bg-gray-900,
[data-theme="semilight"] .bg-gray-900 {
  background-color: var(--color-background) !important;
  color: var(--color-text) !important;
}

/* Light theme border overrides */
[data-theme="light"] .border-gray-600,
[data-theme="semilight"] .border-gray-600 {
  border-color: var(--color-border) !important;
}

[data-theme="light"] .border-gray-700,
[data-theme="semilight"] .border-gray-700 {
  border-color: var(--color-border) !important;
}

/* Light theme text color overrides */
[data-theme="light"] .text-gray-300,
[data-theme="semilight"] .text-gray-300 {
  color: var(--color-textSecondary) !important;
}

[data-theme="light"] .text-gray-400,
[data-theme="semilight"] .text-gray-400 {
  color: var(--color-textSecondary) !important;
}

[data-theme="light"] .text-gray-500,
[data-theme="semilight"] .text-gray-500 {
  color: var(--color-textMuted, var(--color-textSecondary)) !important;
}

[data-theme="light"] .text-white,
[data-theme="semilight"] .text-white {
  color: var(--color-text) !important;
}

/* Light theme input elements styling */
[data-theme="light"] input[type="text"],
[data-theme="light"] input[type="number"],
[data-theme="light"] input[type="password"],
[data-theme="light"] input[type="email"],
[data-theme="light"] select,
[data-theme="light"] textarea,
[data-theme="semilight"] input[type="text"],
[data-theme="semilight"] input[type="number"],
[data-theme="semilight"] input[type="password"],
[data-theme="semilight"] input[type="email"],
[data-theme="semilight"] select,
[data-theme="semilight"] textarea {
  background-color: var(--color-input, #ffffff) !important;
  color: var(--color-text) !important;
  border-color: var(--color-border) !important;
}

[data-theme="light"] input[type="text"]:focus,
[data-theme="light"] input[type="number"]:focus,
[data-theme="light"] input[type="password"]:focus,
[data-theme="light"] select:focus,
[data-theme="light"] textarea:focus,
[data-theme="semilight"] input[type="text"]:focus,
[data-theme="semilight"] input[type="number"]:focus,
[data-theme="semilight"] input[type="password"]:focus,
[data-theme="semilight"] select:focus,
[data-theme="semilight"] textarea:focus {
  border-color: var(--color-accent) !important;
  outline-color: var(--color-accent) !important;
}

/* ─── Tool Tab Embedded Mode ─────────────────────────────────────
   When a tool (which normally renders as a modal dialog) is embedded
   in a session tab, strip the backdrop overlay and make the dialog
   content fill the entire tab area.
   ──────────────────────────────────────────────────────────────── */

/* The outer modal wrapper (fixed inset-0 backdrop) becomes a simple fill container.
   pointer-events:none prevents the click-to-dismiss handler on the backdrop. */
.tool-tab-embedded > div[class*="fixed"] {
  position: absolute !important;
  inset: 0 !important;
  background: transparent !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  z-index: 0 !important;
  display: flex !important;
  align-items: stretch !important;
  justify-content: stretch !important;
  padding: 0 !important;
  pointer-events: none !important;
}

/* The inner dialog card fills the tab instead of being a centered box.
   pointer-events:auto re-enables interaction on the actual content. */
.tool-tab-embedded > div[class*="fixed"] > div {
  width: 100% !important;
  max-width: 100% !important;
  max-height: 100% !important;
  height: 100% !important;
  margin: 0 !important;
  border-radius: 0 !important;
  border: none !important;
  pointer-events: auto !important;
}

/* Centralized modal/dialog primitives */
.sor-modal-backdrop {
  position: fixed;
  inset: 0;
  z-index: 50;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgb(0 0 0 / 0.5);
}

.sor-modal-panel {
  width: 100%;
  max-height: 90vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: 0.75rem;
  box-shadow: 0 25px 60px rgb(0 0 0 / 0.35);
}

.sor-modal-content {
  display: flex;
  flex: 1;
  min-height: 0;
  flex-direction: column;
}

.sor-modal-header {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.75rem;
  padding: 0.875rem 1.25rem;
  border-bottom: 1px solid var(--color-border);
  background: color-mix(in srgb, var(--color-surface) 85%, transparent);
}

.sor-modal-title {
  color: var(--color-text);
  font-size: 0.9375rem;
  font-weight: 600;
}

.sor-modal-header-actions {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.sor-modal-close-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: 0.5rem;
  padding: 0.5rem;
  color: var(--color-textSecondary);
  transition: background-color 150ms ease, color 150ms ease;
}

.sor-modal-close-btn:hover {
  color: var(--color-text);
  background: var(--color-surfaceHover);
}

.sor-modal-body {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
}

.sor-modal-footer {
  display: flex;
  justify-content: flex-end;
  gap: 0.75rem;
  padding: 0.875rem 1.25rem;
  border-top: 1px solid var(--color-border);
}

.sor-manager-panel {
  max-width: 64rem;
  height: 85vh;
}

/* Centralized settings primitives */
.sor-settings-section-header {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid var(--color-border);
  color: var(--color-textSecondary);
  font-size: 0.875rem;
  font-weight: 500;
}

.sor-settings-card {
  border: 1px solid var(--color-border);
  border-radius: 0.5rem;
  padding: 1rem;
  background: color-mix(in srgb, var(--color-surface) 40%, transparent);
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.sor-settings-toggle-row {
  display: flex;
  align-items: flex-start;
  gap: 0.75rem;
  cursor: pointer;
}

.sor-settings-checkbox {
  width: 1rem;
  height: 1rem;
  margin-top: 0.125rem;
  border-radius: 0.25rem;
  border: 1px solid var(--color-border);
  background: var(--color-border);
  color: #2563eb;
}

.sor-settings-toggle-icon {
  margin-top: 0.125rem;
  display: flex;
  align-items: center;
  color: var(--color-textSecondary);
}

.sor-settings-toggle-label {
  color: var(--color-textSecondary);
  font-size: 0.875rem;
}

.sor-settings-toggle-description {
  margin-top: 0.125rem;
  color: #6b7280;
  font-size: 0.6875rem;
}

.sor-settings-slider-row,
.sor-settings-select-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 1rem;
}

.sor-settings-row-label {
  color: var(--color-textSecondary);
  font-size: 0.875rem;
}

.sor-settings-slider-controls {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.sor-settings-range {
  width: 7rem;
  accent-color: #3b82f6;
}

.sor-settings-slider-value {
  width: 3.5rem;
  text-align: right;
  color: var(--color-textSecondary);
  font-size: 0.75rem;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}

.sor-settings-select {
  padding: 0.25rem 0.5rem;
  border-radius: 0.375rem;
  border: 1px solid var(--color-border);
  background: var(--color-border);
  color: var(--color-text);
  font-size: 0.875rem;
}

.sor-settings-collapsible {
  border: 1px solid var(--color-border);
  border-radius: 0.5rem;
  overflow: hidden;
}

.sor-settings-collapsible-trigger {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.5rem;
  padding: 0.75rem 1rem;
  background: var(--color-surfaceHover);
  color: var(--color-textSecondary);
  transition: background-color 150ms ease;
}

.sor-settings-collapsible-trigger:hover {
  background: var(--color-border);
}

.sor-settings-collapsible-title {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  color: var(--color-text);
  font-weight: 500;
}

.sor-settings-collapsible-body {
  padding: 1rem;
  background: var(--color-surface);
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

/* Centralized data table primitives */
.sor-data-table {
  width: 100%;
}

.sor-data-table thead {
  position: sticky;
  top: 0;
  z-index: 1;
}

.sor-data-table tbody {
  border-top: 1px solid color-mix(in srgb, var(--color-border) 60%, transparent);
}

/* Toolbar anchored status popups */
.sor-toolbar-popup {
  position: fixed;
  width: 24rem;
  z-index: 9999;
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: 0.5rem;
  box-shadow: 0 20px 48px rgb(0 0 0 / 0.35);
}
